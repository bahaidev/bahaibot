function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=globalThis.jsonExtra,g=function(e){return e.replace(/\\+/g,(function(e){return e.slice(0,e.length/2)}))},b=function(e){return m.parse("{"+(e||"").replace(/^\{/,"").replace(/\}$/,"")+"}")},v=function(e,t,n){var r,o=n.onMatch,a=n.extra,i=n.betweenMatches,s=n.afterMatch,c=n.escapeAtOne,u=0;for(a&&(i=a,s=a,c=a);null!==(r=e.exec(t));){var l=y(r,2),f=l[0],h=l[1],d=e.lastIndex,m=d-f.length;m>u&&i(t.slice(u,m)),c&&h.length%2?(u=d,c(f)):(o.apply(void 0,p(r)),u=d)}u!==t.length&&s(t.slice(u))},w="undefined"!=typeof fetch?fetch:null,k=function(){return w},S="undefined"!=typeof document?document:null,A=function(){return S};var I=function(e,t,n){return t.sort(new Intl.Collator(e,n).compare)},j=function(e,t,n){return new Intl.ListFormat(e,n).format(t)},O=function(e,t,n,r,o){if("function"!=typeof n)return function(e,t,n,r){return I(e,t,r),j(e,t,n)}(e,t,n,r);I(e,t,o);var a,i=(a=Date.now(),"undefined"!=typeof performance&&"function"==typeof performance.now&&(a+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=Math.trunc((a+16*Math.random())%16);return a=Math.floor(a/16),("x"===e?t:3&t|8).toString(16)}))),s=p(t).map((function(e,t){return"<<".concat(i).concat(t,">>")})),c=[],u=function(){c.push.apply(c,arguments)};v(new RegExp("<<".concat(i,"(\\d)>>"),"gu"),j(e,s,r),{betweenMatches:u,afterMatch:u,onMatch:function(e,r){u(n(t[r],r))}});var l=A().createDocumentFragment();return l.append.apply(l,c),l},T=function(e){var t=e.object;if(Array.isArray(t)){if("function"==typeof t[1]){var n=y(t,4);return{value:n[0],callback:n[1],options:n[2],extraOpts:n[3]}}var r=y(t,3);return{value:r[0],options:r[1],extraOpts:r[2]}}return{value:t}},P=function(e){var r,o=e.value,a=e.arg;e.key;var i,s=e.locale;if("string"==typeof o||o&&"object"===n(o)&&"nodeType"in o)return o;var c=function(e){var n=e.type,r=e.options,o=void 0===r?i:r,s=e.checkArgOptions,c=void 0!==s&&s;if("string"==typeof a){var u=y(a.split("|"),3),l=u[0],f=u[1],p=u[2];"DATE"===l&&(l="DATETIME"),l===n&&(f?c&&!p||(o=t(t({},o),b(c&&p?p:f))):o={})}return o},u=!1;if(o&&"object"===n(o)&&!Array.isArray(o)){var l=Object.keys(o)[0];if(["number","date","datetime","dateRange","datetimeRange","relative","region","language","script","currency","list","plural"].includes(l)){var f,h,d=T({object:o[l]});switch(o=d.value,i=d.options,f=d.extraOpts,h=d.callback,l){case"date":case"datetime":u=!0;break;case"dateRange":case"datetimeRange":return(r=new Intl.DateTimeFormat(s,c({type:"DATERANGE",options:f}))).formatRange.apply(r,p([o,i].map((function(e){return"number"==typeof e?new Date(e):e}))));case"region":case"language":case"script":case"currency":return new Intl.DisplayNames(s,t(t({},c({type:l.toUpperCase()})),{},{type:l})).of(o);case"relative":var m=[i,f];return f=m[0],i=m[1],new Intl.RelativeTimeFormat(s,c({type:"RELATIVE"})).format(o,f);case"list":return h?O(s,o,h,c({type:"LIST"}),c({type:"LIST",options:f,checkArgOptions:!0})):O(s,o,c({type:"LIST"}),c({type:"LIST",options:f,checkArgOptions:!0}))}}}if(o&&("number"==typeof o&&(u||/^DATE(?:TIME)(?:\||$)/.test(a))&&(o=new Date(o)),"object"===n(o)&&"function"==typeof o.getTime))return new Intl.DateTimeFormat(s,c({type:"DATETIME"})).format(o);if(Array.isArray(o)){var g,v=o[2];return(g=new Intl.DateTimeFormat(s,c({type:"DATERANGE",options:v}))).formatRange.apply(g,p(o.slice(0,2).map((function(e){return"number"==typeof e?new Date(e):e}))))}if("number"==typeof o)return new Intl.NumberFormat(s,c({type:"NUMBER"})).format(o);throw new TypeError("Unknown formatter")},E=function e(){r(this,e)},x=function(e){var t=e.key,n=e.body,r=e.type,o=e.messageStyle,a=W({messageStyle:void 0===o?"richNested":o})({body:n},t);if(!a)throw new Error("Key value not found for ".concat(r," key: (").concat(t,")"));return a.value},R=function(e){s(n,E);var t=f(n);function n(e){var o;return r(this,n),(o=t.call(this)).locals=e,o}return a(n,[{key:"getSubstitution",value:function(e){return x({key:e.slice(1),body:this.locals,type:"local"})}},{key:"isMatch",value:function(e){var t=e.slice(1).split("."),n=this.locals;return this.constructor.isMatchingKey(e)&&t.every((function(e){var t=e in n;return n=n[e],t}))}}],[{key:"isMatchingKey",value:function(e){return e.startsWith("-")}}]),n}(),M=function(e){s(n,E);var t=f(n);function n(e){var o;return r(this,n),(o=t.call(this)).substitutions=e,o}return a(n,[{key:"isMatch",value:function(e){return this.constructor.isMatchingKey(e)&&e in this.substitutions}}],[{key:"isMatchingKey",value:function(e){return/^[0-9A-Z_a-z]/.test(e)}}]),n}(),$=function(e){s(i,E);var o=f(i);function i(e,t){var n,a=t.substitutions;return r(this,i),(n=o.call(this)).switches=e,n.substitutions=a,n}return a(i,[{key:"getSubstitution",value:function(e,r){var o,a,i=r.locale,s=r.usedKeys,c=r.arg,u=r.missingSuppliedFormatters,l=this.constructor.getKey(e).slice(1),f=y(this.getMatch(l),3),p=f[0],h=f[1],d=f[2];if(s.push(d),p&&p.includes("|")){var m=y(p.split("|"),3);o=m[1],a=m[2]}if(!h)return u({key:e,formatter:this}),"\\{"+e+"}";var g=function(e,n){var r=b(a);return new Intl.NumberFormat(i,t(t({},n),r)).format(e)},v=function(e,n){var r=b(a);return new Intl.PluralRules(i,t(t({},n),r)).select(e)},w=this.substitutions[d],k=w;if("number"==typeof w)switch(o){case"NUMBER":k=g(w);break;case"PLURAL":k=v(w);break;default:k=new Intl.PluralRules(i).select(w)}else if(w&&"object"===n(w)){var S=Object.keys(w)[0];if(["number","plural"].includes(S)){var A=T({object:w[S]}),I=A.value,j=A.options;if(o||(o=S.toUpperCase()),!(S.toUpperCase()===o))throw new TypeError('Expecting type "'.concat(o.toLowerCase(),'"; instead found "').concat(S,'".'));switch(o){case"NUMBER":k=g(I,j);break;case"PLURAL":k=v(I,j)}}}var O="richNested",P=function(e){return e.replace(/\\/g,"\\\\").replace(/\./g,"\\.")};try{return x({messageStyle:O,key:k?P(k):c,body:h,type:"switch"})}catch(e){try{return x({messageStyle:O,key:"*"+P(k),body:h,type:"switch"})}catch(e){var E=Object.keys(h).find((function(e){return e.startsWith("*")}));if(!E)throw new Error("No defaults found for switch ".concat(l));return x({messageStyle:O,key:P(E),body:h,type:"switch"})}}}},{key:"isMatch",value:function(e){return e&&this.constructor.isMatchingKey(e)&&Boolean(this.getMatch(e.slice(1)).length)}},{key:"getMatch",value:function(e){var t=this,n=e.split(".");return n.reduce((function(r,o,a){if(a<n.length-1){if(!(o in r))throw new Error('Switch key "'.concat(o,'" not found (from "~').concat(e,'")'));return r[o]}var i=Object.entries(r).find((function(e){var n=y(e,1)[0];return o===t.constructor.getKey(n)}));return i?[].concat(p(i),[o]):[]}),this.switches)}}],[{key:"isMatchingKey",value:function(e){return e.startsWith("~")}},{key:"getKey",value:function(e){var t=e.match(/^(?:(?!\|)[\s\S])*/);return t&&t[0]}}]),i}();function N(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function D(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function F(e,t,n){if(!e.s){if(n instanceof B){if(!n.s)return void(n.o=F.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(F.bind(null,e,t),F.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var B=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var a=1&o?t:n;if(a){try{F(r,1,a(this.v))}catch(e){F(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?F(r,1,t?t(o):o):n?F(r,1,n(o)):F(r,2,o)}catch(e){F(r,2,e)}},r},e}();function L(e){return e instanceof B&&1&e.s}function U(e,t,n){for(var r;;){var o=e();if(L(o)&&(o=o.v),!o)return a;if(o.then){r=0;break}var a=n();if(a&&a.then){if(!L(a)){r=1;break}a=a.s}if(t){var i=t();if(i&&i.then&&!L(i)){r=2;break}}}var s=new B,c=F.bind(null,s,2);return(0===r?o.then(l):1===r?a.then(u):i.then(f)).then(void 0,c),s;function u(r){a=r;do{if(t&&(i=t())&&i.then&&!L(i))return void i.then(f).then(void 0,c);if(!(o=e())||L(o)&&!o.v)return void F(s,1,a);if(o.then)return void o.then(l).then(void 0,c);L(a=n())&&(a=a.v)}while(!a||!a.then);a.then(u).then(void 0,c)}function l(e){e?(a=n())&&a.then?a.then(u).then(void 0,c):u(a):F(s,1,a)}function f(){(o=e())?o.then?o.then(l).then(void 0,c):l(o):F(s,1,a)}}function _(e,t){return e&&e.then?e.then(t):t(e)}function C(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var H=function(e,t){if("string"!=typeof e)throw new TypeError("`defaultLocaleResolver` expects a string `localesBasePath`.");if("string"!=typeof t)throw new TypeError("`defaultLocaleResolver` expects a string `locale`.");if(/[\.\/\\]/.test(t))throw new TypeError("Locales cannot use file-reserved characters, `.`, `/` or `\\`");return"".concat(e.replace(/\/$/,""),"/_locales/").concat(t,"/messages.json")},G=function(e){var r=e.string,o=e.dom,a=e.usedKeys,i=e.substitutions,s=e.allSubstitutions,c=e.locale,u=e.locals,l=e.switches,f=e.maximumLocalNestingDepth,h=void 0===f?3:f,d=e.missingSuppliedFormatters,m=e.checkExtraSuppliedFormatters;if("number"!=typeof h)throw new TypeError("`maximumLocalNestingDepth` must be a number.");var w=function(){Object.entries(i).forEach((function(e){var t=y(e,2),n=t[0];"function"==typeof t[1]&&a.push(n)}))};w();var k=new R(u),S=new M(i),A=new $(l,{substitutions:i}),I=/(\\*)\{((?:(?:(?!\})[\s\S])|\\\})*?)(?:(\|)((?:(?!\})[\s\S])*))?\}/g;s&&(s=Array.isArray(s)?s:[s]);var j=function(e){var t,n=e.key,r=e.arg,o=e.substs;return k.constructor.isMatchingKey(n)?t=k.getSubstitution(n):A.constructor.isMatchingKey(n)?t=A.getSubstitution(n,{locale:c,usedKeys:a,arg:r,missingSuppliedFormatters:d}):"function"==typeof(t=o[n])&&(t=t({arg:r,key:n})),s?t=s.reduce((function(e,t){return t({value:e,arg:r,key:n,locale:c})}),t):r&&/^(?:NUMBER|DATE(?:TIME|RANGE|TIMERANGE)?|REGION|LANGUAGE|SCRIPT|CURRENCY|RELATIVE|LIST)(?:\||$)/.test(r)&&(t=P({value:t,arg:r,key:n,locale:c})),t},O=1,T=function(e){var n=e.substitution,r=e.ky,o=e.arg,a=e.processSubsts;if("string"==typeof n&&n.includes("{")){if(O++>h)throw new TypeError("Too much recursion in local variables.");if(k.constructor.isMatchingKey(r)){var s,c=i;o&&(s=b(o),c=t(t({},i),s)),n=a({str:n,substs:c,formatter:k}),s&&m({substitutions:s})}else A.constructor.isMatchingKey(r)&&(n=a({str:n}))}return n};if(!o){var E=!1,x=function e(t){var r=t.str,o=t.substs,s=void 0===o?i:o,c=t.formatter,u=void 0===c?S:c;return r.replace(I,(function(t,r,o,i,c){if(r.length%2)return t;if(d({key:o,formatter:u}))return t;var l=j({key:o,arg:c,substs:s});return l=T({substitution:l,ky:o,arg:c,processSubsts:e}),E=E||l&&"object"===n(l)&&"nodeType"in l,a.push(o),r+l}))}({str:r});if(!E)return m({substitutions:i}),a.length=0,w(),g(x);a.length=0,w()}O=1;var N=function e(t){var r=t.str,o=t.substs,s=void 0===o?i:o,c=t.formatter,u=void 0===c?S:c,l=[],f=new RegExp(I,"gu"),y=function(){l.push.apply(l,arguments)};return v(f,r,{extra:y,onMatch:function(t,r,o,i,c){if(d({key:o,formatter:u}))y(t);else{r.length&&y(r);var l=j({key:o,arg:c,substs:s});l=T({substitution:l,ky:o,arg:c,processSubsts:e}),Array.isArray(l)?y.apply(void 0,p(l)):l&&"object"===n(l)&&"nodeType"in l?y(l.cloneNode(!0)):y(l)}a.push(o)}}),l}({str:r});return m({substitutions:i}),a.length=0,N.map((function(e){return"string"==typeof e?g(e):e}))},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.messageStyle,r=void 0===t?"richNested":t;return"function"==typeof r?r:"richNested"===r?function(e,t){var r=e&&"object"===n(e)&&e.body,o=[],a=function(e){o.length||(o[0]=""),o[o.length-1]+=e};v(/(\\*)\./g,t,{extra:a,onMatch:function(e,t){a(t),o.push("")}});var i=o.map((function(e){return g(e)})),s=!1,c=r;return i.some((function(e,t,r){return!c||"object"!==n(c)||(t===r.length-1&&e in c&&c[e]&&"object"===n(c[e])&&"message"in c[e]&&"string"==typeof c[e].message&&(s={value:c[e].message,info:c[e]}),c=c[e],!1)})),s}:"rich"===r?function(e,t){var r=e&&"object"===n(e)&&e.body;return!!(r&&"object"===n(r)&&t in r&&r[t]&&"object"===n(r[t])&&"message"in r[t]&&"string"==typeof r[t].message)&&{value:r[t].message,info:r[t]}}:"plain"===r?function(e,t){var r=e&&"object"===n(e)&&e.body;return!!(r&&"object"===n(r)&&t in r&&r[t]&&"string"==typeof r[t])&&{value:r[t]}}:function(){throw new TypeError("Unknown `messageStyle` ".concat(r))}()},z=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.message,o=t.defaults,a=t.messageStyle,i=t.messageForKey,s=void 0===i?W({messageStyle:a}):i,c=t.key;if("string"!=typeof c)throw new TypeError("An options object with a `key` string is expected on `getStringFromMessageAndDefaults`");if("string"==typeof r)e=r;else if(!1===o||null==o)e=!1;else{if(!o||"object"!==n(o))throw new TypeError("Default locale strings must resolve to `false`, nullish, or an object!");(e=s({body:o},c))&&(e=e.value)}if(!1===e)throw new Error("Key value not found for key: (".concat(c,")"));return e},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,n=e.locale,r=e.locals,o=e.switches;e.maximumLocalNestingDepth;var a=e.allSubstitutions,i=void 0===a?[P]:a,s=e.insertNodes,c=void 0===s?G:s,u=e.substitutions,l=void 0!==u&&u,f=e.dom,y=void 0!==f&&f,h=e.forceNodeReturn,d=void 0!==h&&h,m=e.throwOnMissingSuppliedFormatters,g=void 0===m||m,b=e.throwOnExtraSuppliedFormatters,v=void 0===b||b;if("string"!=typeof t)throw new TypeError("An options object with a `string` property set to a string must be provided for `getDOMForLocaleString`.");var w=function(e){var t=A();return d?t.createTextNode(e):e},k=[],S=function(e){var t=e.substitutions;v&&Object.keys(t).forEach((function(e){if(!k.includes(e))throw new Error("Extra formatting key: ".concat(e))}))},I=function(e){var t=e.key,n=e.formatter,r=n.isMatch(t);if(n.constructor.isMatchingKey(t)&&!r){if(g)throw new Error("Missing formatting key: ".concat(t));return!0}return!1};if(!l&&!i&&!g)return w(t);l||(l={});var j=c({string:t,dom:y,usedKeys:k,substitutions:l,allSubstitutions:i,locale:n,locals:r,switches:o,missingSuppliedFormatters:I,checkExtraSuppliedFormatters:S});if("string"==typeof j)return w(j);var O=A(),T=O.createDocumentFragment();return T.append.apply(T,p(j)),T};function K(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function J(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var V=function(e){if(!e.includes("-"))throw new Error("Locale not available");return e.replace(/\x2D(?:(?!\x2D)[\s\S])*$/,"")},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,n=e.defaultLocales,r=e.localeResolver,o=e.localesBasePath,a=e.localeMatcher;return Q({locales:t,defaultLocales:n,localeResolver:r,localesBasePath:o,localeMatcher:a})},Q=J((function(e){var t=J((function(e){if("string"!=typeof e)throw new TypeError("Non-string locale type");var n=s(u,e);if("string"!=typeof n)throw new TypeError("`localeResolver` expected to resolve to (URL) string.");return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){var t=k();return K(h?t(n,{method:"HEAD"}):t(n),(function(t){if(404===t.status)throw new Error("Trying again");return h?e:K(t.json(),(function(t){return{locale:e,strings:t}}))}))}),(function(n){if("SyntaxError"===n.name)throw n;return K(f(e),t)}))})),n=e.locales,r=void 0===n?"undefined"!=typeof intlDomLocale?[intlDomLocale]:"undefined"==typeof navigator?[]:navigator.languages:n,o=e.defaultLocales,a=void 0===o?["en-US"]:o,i=e.localeResolver,s=void 0===i?H:i,c=e.localesBasePath,u=void 0===c?".":c,l=e.localeMatcher,f=void 0===l?"lookup":l,y=e.headOnly,h=void 0!==y&&y;if("lookup"===f)f=V;else if("function"!=typeof f)throw new TypeError('`localeMatcher` must be "lookup" or a function!');return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Reached end of values array.";if(!Array.isArray(e))throw new TypeError("The `values` argument to `promiseChainForValues` must be an array.");if("function"!=typeof t)throw new TypeError("The `errBack` argument to `promiseChainForValues` must be a function.");return C((function(){var r,o,a=!1,i=Promise.reject(new Error("Intentionally reject so as to begin checking chain"));return _(U((function(){return!a}),void 0,(function(){var s=e.shift();return D((function(){return N(i,(function(e){r=e,a=!0}))}),(function(){if(o)throw new Error(n);e.length||(o=!0),i=t(s)}))})),(function(e){return r}))}))()}([].concat(p(r),p(a)),t,"No matching locale found!")}));function X(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Z,ee=function(e){var r=e.strings,o=e.resolvedLocale,a=e.messageStyle,i=e.allSubstitutions,s=e.insertNodes,c=e.defaults,u=e.substitutions,l=e.maximumLocalNestingDepth,f=e.dom,y=void 0!==f&&f,p=e.forceNodeReturn,h=void 0!==p&&p,d=e.throwOnMissingSuppliedFormatters,m=void 0===d||d,g=e.throwOnExtraSuppliedFormatters,b=void 0===g||g;if(!r||"object"!==n(r))throw new TypeError("Locale strings must be an object!");var v=W({messageStyle:a}),w=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=a.allSubstitutions,p=void 0===f?i:f,d=a.defaults,g=void 0===d?c:d,w=a.dom,k=void 0===w?y:w,S=a.forceNodeReturn,A=void 0===S?h:S,I=a.throwOnMissingSuppliedFormatters,j=void 0===I?m:I,O=a.throwOnExtraSuppliedFormatters,T=void 0===O?b:O,P=v(r,e),E=z({message:!(!P||"string"!=typeof P.value)&&P.value,defaults:g,messageForKey:v,key:e});return q({string:E,locals:r.head&&r.head.locals,switches:r.head&&r.head.switches,locale:o,maximumLocalNestingDepth:l,allSubstitutions:p,insertNodes:s,substitutions:t(t({},u),n),dom:k,forceNodeReturn:A,throwOnMissingSuppliedFormatters:j,throwOnExtraSuppliedFormatters:T})};return w.resolvedLocale=o,w.strings=r,w.sort=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return I.apply(void 0,[o].concat(t))},w.sortList=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return O.apply(void 0,[o].concat(t))},w.list=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return j.apply(void 0,[o].concat(t))},w},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.locales,n=e.defaultLocales,r=e.localeStringFinder,o=void 0===r?Y:r,a=e.localesBasePath,i=e.localeResolver,s=e.localeMatcher,c=e.messageStyle,u=e.allSubstitutions,l=e.insertNodes,f=e.defaults,y=e.substitutions,p=e.maximumLocalNestingDepth,h=e.dom,d=e.forceNodeReturn,m=e.throwOnMissingSuppliedFormatters,g=e.throwOnExtraSuppliedFormatters;try{return X(o({locales:t,defaultLocales:n,localeResolver:i,localesBasePath:a,localeMatcher:s}),(function(e){var t=e.strings,n=e.locale;return ee({strings:t,resolvedLocale:n,messageStyle:c,allSubstitutions:u,insertNodes:l,defaults:f,substitutions:y,maximumLocalNestingDepth:p,dom:h,forceNodeReturn:d,throwOnMissingSuppliedFormatters:m,throwOnExtraSuppliedFormatters:g})}))}catch(e){return Promise.reject(e)}},ne="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},re={exports:{}};Z=re,function(e){if("function"!=typeof t){var t=function(e){return e};t.nonNative=!0}const n=t("plaintext"),r=t("html"),o=t("comment"),a=/<(\w*)>/g,i=/<\/?([^\s\/>]+)/;function s(e,t,n){return u(e=e||"",c(t=t||[],n=n||""))}function c(e,r){return{allowable_tags:e=function(e){let n=new Set;if("string"==typeof e){let t;for(;t=a.exec(e);)n.add(t[1])}else t.nonNative||"function"!=typeof e[t.iterator]?"function"==typeof e.forEach&&e.forEach(n.add,n):n=new Set(e);return n}(e),tag_replacement:r,state:n,tag_buffer:"",depth:0,in_quote_char:""}}function u(e,t){if("string"!=typeof e)throw new TypeError("'html' parameter must be a string");let a=t.allowable_tags,i=t.tag_replacement,s=t.state,c=t.tag_buffer,u=t.depth,f=t.in_quote_char,y="";for(let t=0,p=e.length;t<p;t++){let p=e[t];if(s===n)switch(p){case"<":s=r,c+=p;break;default:y+=p}else if(s===r)switch(p){case"<":if(f)break;u++;break;case">":if(f)break;if(u){u--;break}f="",s=n,c+=">",a.has(l(c))?y+=c:y+=i,c="";break;case'"':case"'":f=p===f?"":f||p,c+=p;break;case"-":"<!-"===c&&(s=o),c+=p;break;case" ":case"\n":if("<"===c){s=n,y+="< ",c="";break}c+=p;break;default:c+=p}else if(s===o)switch(p){case">":"--"==c.slice(-2)&&(s=n),c="";break;default:c+=p}}return t.state=s,t.tag_buffer=c,t.depth=u,t.in_quote_char=f,y}function l(e){let t=i.exec(e);return t?t[1].toLowerCase():null}s.init_streaming_mode=function(e,t){let n=c(e=e||[],t=t||"");return function(e){return u(e||"",n)}},Z.exports?Z.exports=s:e.striptags=s}(ne);var oe=re.exports;var ae={},ie={},se={},ce=function(e,t,n,r){if(this.bucketSize=e,this.tokensPerInterval=t,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+n)}else this.interval=n;this.parentBucket=r,this.content=0,this.lastDrip=+new Date};ce.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(e,t){var n=this;return this.bucketSize?e>this.bucketSize?(process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),e>this.content?r():this.parentBucket?this.parentBucket.removeTokens(e,(function(o,a){return o?t(o,null):e>n.content?r():(n.content-=e,void t(null,Math.min(a,n.content)))})):(this.content-=e,process.nextTick(t.bind(null,null,this.content)),!0)):(process.nextTick(t.bind(null,null,e,Number.POSITIVE_INFINITY)),!0);function r(){var r=Math.ceil((e-n.content)*(n.interval/n.tokensPerInterval));return setTimeout((function(){n.removeTokens(e,t)}),r),!1}},tryRemoveTokens:function(e){return!this.bucketSize||!(e>this.bucketSize)&&(this.drip(),!(e>this.content)&&(!(this.parentBucket&&!this.parentBucket.tryRemoveTokens(e))&&(this.content-=e,!0)))},drip:function(){if(this.tokensPerInterval){var e=+new Date,t=Math.max(e-this.lastDrip,0);this.lastDrip=e;var n=t*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+n,this.bucketSize)}else this.content=this.bucketSize}};var ue=ce,le=ue,fe=function(){if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime(),t=e[0],n=e[1];return 1e3*t+Math.floor(n/1e6)}return(new Date).getTime()},ye=function(e,t,n){this.tokenBucket=new le(e,e,t,null),this.tokenBucket.content=e,this.curIntervalStart=fe(),this.tokensThisInterval=0,this.fireImmediately=n};ye.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(e,t){if(e>this.tokenBucket.bucketSize)return process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var n=this,r=fe();if((r<this.curIntervalStart||r-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=r,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(t.bind(null,null,-1));else{var o=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-r);setTimeout((function(){n.tokenBucket.removeTokens(e,a)}),o)}return!1}return this.tokenBucket.removeTokens(e,a);function a(r,o){if(r)return t(r,null);n.tokensThisInterval+=e,t(null,o)}},tryRemoveTokens:function(e){if(e>this.tokenBucket.bucketSize)return!1;var t=fe();if((t<this.curIntervalStart||t-this.curIntervalStart>=this.tokenBucket.interval)&&(this.curIntervalStart=t,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)return!1;var n=this.tokenBucket.tryRemoveTokens(e);return n&&(this.tokensThisInterval+=e),n},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}};var pe=ye;se.RateLimiter=pe,se.TokenBucket=ue,Object.defineProperty(ie,"__esModule",{value:!0}),ie.RateLimiter=void 0;const he=se;function de(e){let t=e;const n=Math.floor(t/86400);t%=86400;const r=Math.floor(t/3600);t%=3600;const o=Math.floor(t/60),a=Math.floor(t%60);let i="";if(0===Math.floor(e))i="0s";else{const e=0===n,t=0===r,s=0===o,c=0===a;i+=e?"":`${n}d`,i+=e||t&&s&&c?"":", ",i+=t?"":`${r}h`,i+=t||s&&c?"":", ",i+=s?"":`${o}m`,i+=s||c?"":", ",i+=c?"":`${a}s`}return i}ie.RateLimiter=class{constructor(e,t){this.amount=e,this.interval=t,this.limiters={}}take(e){let t=this.limiters[e];return t||(t=new he.RateLimiter(this.amount,this.interval),this.limiters[e]=t),t.getTokensRemaining()<1||(t.removeTokens(1,(e=>{if(e)throw e})),!1)}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RateLimiter=void 0;var t=ie;Object.defineProperty(e,"RateLimiter",{enumerable:!0,get:function(){return t.RateLimiter}})}(ae);var me="undefined"!=typeof Symbol&&Symbol,ge=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},be=function(){return"function"==typeof me&&("function"==typeof Symbol&&("symbol"==typeof me("foo")&&("symbol"==typeof Symbol("bar")&&ge())))},ve="Function.prototype.bind called on incompatible ",we=Array.prototype.slice,ke=Object.prototype.toString,Se=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==ke.call(t))throw new TypeError(ve+t);for(var n,r=we.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(we.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(we.call(arguments)))},a=Math.max(0,t.length-r.length),i=[],s=0;s<a;s++)i.push("$"+s);if(n=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var c=function(){};c.prototype=t.prototype,n.prototype=new c,c.prototype=null}return n},Ae=Function.prototype.bind||Se,Ie=Ae.call(Function.call,Object.prototype.hasOwnProperty),je=SyntaxError,Oe=Function,Te=TypeError,Pe=function(e){try{return Oe('"use strict"; return ('+e+").constructor;")()}catch(e){}},Ee=Object.getOwnPropertyDescriptor;if(Ee)try{Ee({},"")}catch(e){Ee=null}var xe,Re,Me=function(){throw new Te},$e=Ee?function(){try{return Me}catch(e){try{return Ee(arguments,"callee").get}catch(e){return Me}}}():Me,Ne=be(),De=Object.getPrototypeOf||function(e){return e.__proto__},Fe={},Be="undefined"==typeof Uint8Array?undefined:De(Uint8Array),Le={"%AggregateError%":"undefined"==typeof AggregateError?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":Ne?De([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":Fe,"%AsyncGenerator%":Fe,"%AsyncGeneratorFunction%":Fe,"%AsyncIteratorPrototype%":Fe,"%Atomics%":"undefined"==typeof Atomics?undefined:Atomics,"%BigInt%":"undefined"==typeof BigInt?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?undefined:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?undefined:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?undefined:FinalizationRegistry,"%Function%":Oe,"%GeneratorFunction%":Fe,"%Int8Array%":"undefined"==typeof Int8Array?undefined:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?undefined:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ne?De(De([][Symbol.iterator]())):undefined,"%JSON%":"object"==typeof JSON?JSON:undefined,"%Map%":"undefined"==typeof Map?undefined:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Ne?De((new Map)[Symbol.iterator]()):undefined,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?undefined:Promise,"%Proxy%":"undefined"==typeof Proxy?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?undefined:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?undefined:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Ne?De((new Set)[Symbol.iterator]()):undefined,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ne?De(""[Symbol.iterator]()):undefined,"%Symbol%":Ne?Symbol:undefined,"%SyntaxError%":je,"%ThrowTypeError%":$e,"%TypedArray%":Be,"%TypeError%":Te,"%Uint8Array%":"undefined"==typeof Uint8Array?undefined:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?undefined:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?undefined:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?undefined:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?undefined:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?undefined:WeakSet},Ue=function e(t){var n;if("%AsyncFunction%"===t)n=Pe("async function () {}");else if("%GeneratorFunction%"===t)n=Pe("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=Pe("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(n=De(o.prototype))}return Le[t]=n,n},_e={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ce=Ae,He=Ie,Ge=Ce.call(Function.call,Array.prototype.concat),We=Ce.call(Function.apply,Array.prototype.splice),ze=Ce.call(Function.call,String.prototype.replace),qe=Ce.call(Function.call,String.prototype.slice),Ke=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Je=/\\(\\)?/g,Ve=function(e){var t=qe(e,0,1),n=qe(e,-1);if("%"===t&&"%"!==n)throw new je("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new je("invalid intrinsic syntax, expected opening `%`");var r=[];return ze(e,Ke,(function(e,t,n,o){r[r.length]=n?ze(o,Je,"$1"):t||e})),r},Ye=function(e,t){var n,r=e;if(He(_e,r)&&(r="%"+(n=_e[r])[0]+"%"),He(Le,r)){var o=Le[r];if(o===Fe&&(o=Ue(r)),void 0===o&&!t)throw new Te("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new je("intrinsic "+e+" does not exist!")},Qe=function(e,t){if("string"!=typeof e||0===e.length)throw new Te("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new Te('"allowMissing" argument must be a boolean');var n=Ve(e),r=n.length>0?n[0]:"",o=Ye("%"+r+"%",t),a=o.name,i=o.value,s=!1,c=o.alias;c&&(r=c[0],We(n,Ge([0,1],c)));for(var u=1,l=!0;u<n.length;u+=1){var f=n[u],y=qe(f,0,1),p=qe(f,-1);if(('"'===y||"'"===y||"`"===y||'"'===p||"'"===p||"`"===p)&&y!==p)throw new je("property names with quotes must have matching quotes");if("constructor"!==f&&l||(s=!0),He(Le,a="%"+(r+="."+f)+"%"))i=Le[a];else if(null!=i){if(!(f in i)){if(!t)throw new Te("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ee&&u+1>=n.length){var h=Ee(i,f);i=(l=!!h)&&"get"in h&&!("originalValue"in h.get)?h.get:i[f]}else l=He(i,f),i=i[f];l&&!s&&(Le[a]=i)}}return i},Xe=Qe("%TypeError%"),Ze=function(e,t){if(null==e)throw new Xe(t||"Cannot call method on "+e);return e},et=Qe("%Object%"),tt=Ze,nt=Function.prototype.toString,rt="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof rt&&"function"==typeof Object.defineProperty)try{xe=Object.defineProperty({},"length",{get:function(){throw Re}}),Re={},rt((function(){throw 42}),null,xe)}catch(e){e!==Re&&(rt=null)}else rt=null;var ot=/^\s*class\b/,at=function(e){try{var t=nt.call(e);return ot.test(t)}catch(e){return!1}},it=Object.prototype.toString,st="function"==typeof Symbol&&!!Symbol.toStringTag,ct="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{},ut=rt?function(e){if(e===ct)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{rt(e,null,xe)}catch(e){if(e!==Re)return!1}return!at(e)}:function(e){if(e===ct)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(st)return function(e){try{return!at(e)&&(nt.call(e),!0)}catch(e){return!1}}(e);if(at(e))return!1;var t=it.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},lt=Date.prototype.getDay,ft=Object.prototype.toString,yt="function"==typeof Symbol&&!!Symbol.toStringTag,pt={exports:{}},ht=Object.prototype.toString;if(be()){var dt=Symbol.prototype.toString,mt=/^Symbol\(.*\)$/;pt.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==ht.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&mt.test(dt.call(e))}(e)}catch(e){return!1}}}else pt.exports=function(e){return!1};var gt,bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,vt=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},wt=ut,kt=function(e){return"object"==typeof e&&null!==e&&(yt?function(e){try{return lt.call(e),!0}catch(e){return!1}}(e):"[object Date]"===ft.call(e))},St=pt.exports,At=function(e,t){if(null==e)throw new TypeError("Cannot call method on "+e);if("string"!=typeof t||"number"!==t&&"string"!==t)throw new TypeError('hint must be "string" or "number"');var n,r,o,a="string"===t?["toString","valueOf"]:["valueOf","toString"];for(o=0;o<a.length;++o)if(n=e[a[o]],wt(n)&&(r=n.call(e),vt(r)))return r;throw new TypeError("No default value")},It=function(e,t){var n=e[t];if(null!=n){if(!wt(n))throw new TypeError(n+" returned for property "+t+" of object "+e+" is not a function");return n}},jt=function(e){if(vt(e))return e;var t,n="default";if(arguments.length>1&&(arguments[1]===String?n="string":arguments[1]===Number&&(n="number")),bt&&(Symbol.toPrimitive?t=It(e,Symbol.toPrimitive):St(e)&&(t=Symbol.prototype.valueOf)),void 0!==t){var r=t.call(e,n);if(vt(r))return r;throw new TypeError("unable to convert exotic object to primitive")}return"default"===n&&(kt(e)||St(e))&&(n="string"),At(e,"default"===n?"number":n)},Ot=Qe,Tt=Ot("%String%"),Pt=Ot("%TypeError%"),Et=Qe("%String%"),xt=function(e){return arguments.length>1?jt(e,arguments[1]):jt(e)},Rt=function(e){if("symbol"==typeof e)throw new Pt("Cannot convert a Symbol value to a string");return Tt(e)},Mt=function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},$t=Qe("%TypeError%"),Nt=Ie,Dt=function(e){return"string"==typeof e||"symbol"==typeof e},Ft=function(e){return"symbol"==typeof e?"Symbol":"bigint"==typeof e?"BigInt":Mt(e)},Bt=function(e){return tt(e),et(e)},Lt=function(e){var t=xt(e,Et);return"symbol"==typeof t?t:Rt(t)},Ut=function(e,t){if("Object"!==Ft(e))throw new $t("Assertion failed: `O` must be an Object");if(!Dt(t))throw new $t("Assertion failed: `P` must be a Property Key");return Nt(e,t)},_t=function(e,t){var n=Bt(e),r=Lt(t);return Ut(n,r)},Ct=Object.prototype.toString,Ht=function(e){var t=Ct.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===Ct.call(e.callee)),n};if(!Object.keys){var Gt=Object.prototype.hasOwnProperty,Wt=Object.prototype.toString,zt=Ht,qt=Object.prototype.propertyIsEnumerable,Kt=!qt.call({toString:null},"toString"),Jt=qt.call((function(){}),"prototype"),Vt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Yt=function(e){var t=e.constructor;return t&&t.prototype===e},Qt={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Xt=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!Qt["$"+e]&&Gt.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{Yt(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();gt=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===Wt.call(e),r=zt(e),o=t&&"[object String]"===Wt.call(e),a=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var i=Jt&&n;if(o&&e.length>0&&!Gt.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(r&&e.length>0)for(var c=0;c<e.length;++c)a.push(String(c));else for(var u in e)i&&"prototype"===u||!Gt.call(e,u)||a.push(String(u));if(Kt)for(var l=function(e){if("undefined"==typeof window||!Xt)return Yt(e);try{return Yt(e)}catch(e){return!1}}(e),f=0;f<Vt.length;++f)l&&"constructor"===Vt[f]||!Gt.call(e,Vt[f])||a.push(Vt[f]);return a}}var Zt=gt,en=Array.prototype.slice,tn=Ht,nn=Object.keys,rn=nn?function(e){return nn(e)}:Zt,on=Object.keys;rn.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return tn(e)?on(en.call(e)):on(e)}):Object.keys=rn;return Object.keys||rn};var an=rn,sn="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),cn=Object.prototype.toString,un=Array.prototype.concat,ln=Object.defineProperty,fn=ln&&function(){var e={};try{for(var t in ln(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),yn=function(e,t,n,r){var o;(!(t in e)||"function"==typeof(o=r)&&"[object Function]"===cn.call(o)&&r())&&(fn?ln(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},pn=function(e,t){var n=arguments.length>2?arguments[2]:{},r=an(t);sn&&(r=un.call(r,Object.getOwnPropertySymbols(t)));for(var o=0;o<r.length;o+=1)yn(e,r[o],t[r[o]],n[r[o]])};pn.supportsDescriptors=!!fn;var hn=function(){return Object.hasOwn||_t},dn=pn;async function mn({fs:e,settings:t}){const n=JSON.parse(await e.readFile(new URL("../../library/library_listing.json",import.meta.url),"utf8")),r=t.embedColor,o=t.embedTextLimit,a=Object.keys(n.index),i=/\bread (?<refName>\S.+) (?<index>[-.\d]+)\b/iu;function s(e,t){const n=e.chapters.length;return(t=Number.parseInt(t)-1)>-1&&t<n?e.chapters[t]:`I know which work you're talking about, but I can't find that section in it. Valid section numbers are from **1** to **${n}**.`}function c(e,t,a,i,s,c){let u="";u="hwa"===s.toLowerCase()||"hwp"===s.toLowerCase()?`**${i}. ${c.title}**\n`:`**Chapter ${i}, Para 1. ${c.title}**\n`;const l=function(e,t){const n=[];for(;e.length>t;){let r=e.slice(0,Math.max(0,t)).lastIndexOf(" ");r=r<=0?t:r,n.push(e.slice(0,Math.max(0,r)));let o=e.indexOf(" ",r)+1;(o<r||o>r+t)&&(o=r),e=e.slice(Math.max(0,o))}return n.push(e),n}(c.paras[0].text,o);l.forEach(((o,i)=>{const f=new e.MessageEmbed;if(f.setColor(r),f.setAuthor(`${n.list[n.index[s]].title} by ${n.list[n.index[s]].author}`,t),u+=o,f.setDescription(u),i===l.length-1&&void 0!==c.notes&&c.notes.length>0){let e="";for(const t of c.notes)e+=`${t.fn}. ${t.note}\n`;""!==e&&f.addField("Notes",e)}a.channel.send(f),u=""}))}async function u(t){return JSON.parse(await e.readFile(new URL(`../../library/${n.list[n.index[t]].filename}`,import.meta.url),"utf8"))}return{showList:function(e){const t=function(){let e="";for(const t of n.list)e+=`\n**${t.code.toUpperCase()}**: ${t.title} (${t.author})`;return e+="\n",e}();e.channel.send({content:`The following texts are available in my library, ${e.author.username}.`,embed:{color:8359053,description:"\nTo read from one of these texts, mention the book name and the section you're interested in. For example, to read the 12th Arabic Hidden Word, say: `!read HWA 12`.",fields:[{name:"Available Texts",value:t}]}})},readBook:async function(e,t,r){const o=e.content;let{refName:a,index:l}=o.match(i).groups;if(!Object.hasOwn(n.index,a.toLowerCase()))return;a=a.toLowerCase();const f=s(await u(a),l);"object"==typeof f?c(r,t,e,l,a,f):e.channel.send(f)},readRandom:async function(e,t,n){const r=a[Math.floor(Math.random()*a.length)],o=await u(r),i=Math.floor(Math.random()*o.chapters.length);c(n,t,e,i,r,s(o,i))},reader:function(e){e.channel.send("I couldn't understand your request. Make sure you format your request like this: ``read <work> <section number>``. To see the list of works in my library, type ``read list``.")}}}!function(){var e=hn();dn(Object,{hasOwn:e},{values:function(){return Object.hasOwn!==e}})}();const gn=function({wikiTools:e,client:t,_:n}){async function r(r,{forceToday:c}={}){const u=/!(?:bp|pedia|b9|bahai9|bm|media|img)/giu,l=r.content.split(" "),f=l.findIndex((e=>e.match(u)));l.splice(0,f+1);const y=/-(?:r|rnd|rand)/giu,p=/-(?:t|tih|today)/giu,h=/-(?<nr>[1-5])/iu,d=l.join(" ");let m=!1,g=1,b=!1,v="",w="",k=!1;if(o.re.test(r.content))m=!0;else{s.re.test(r.content)?(v="bahaipedia.org",w="Bahaipedia"):a.re.test(r.content)?(v="bahai9.com",w="Bahai9",k=!0):i.re.test(r.content)&&(v="bahai.media",w="Bahaimedia");const e=l.findIndex((e=>e.match(y)));if(e>=0)b=!0,l.splice(e,1);else{const e=l.findIndex((e=>e.match(p)));e>=0&&(m=!0,l.splice(e,1))}const t=l.findIndex((e=>e.match(h)));t>=0&&(g=Number(l[t]),l.splice(t,1))}const S=t.emojis.cache.find((e=>"bstar"===e.name)),A=S?.toString()?`${S.toString()} `:"";if(S&&r.react(S),b)try{await async function(t,n,r,o,a,i){let s;try{s=await e.wikiGetRandom(n,r,i)}catch(e){return void console.error("Error getting wiki random",e)}const c=s&&s.title&&s;if(c)return console.log("Query completed."),void t.channel.send({content:"Here is the result of your query.",embed:{color:3447003,description:`${o}${a} has returned the following random page, ${t.author.username}:\n\n **[${c.title}](${c.url})**`,image:{url:""!==c.img?c.img:""}}});t.channel.send({content:"Here is the result of your query.",embed:{color:3447003,description:`${o}${a} did not return any results for your query, ${t.author.username}. There may have been a network problem. If you think you're getting this message in error, you may want to try again later.`}})}(r,g,v,A,w,k)}catch(e){return void console.error("Error with random wiki",e)}else if(m&&(c||"bahaipedia.org"===v))try{await async function(t,r){let o;try{o=await e.bpGetToday()}catch(e){return void console.error("Error getting Bahaipedia Today",e)}if(o){console.log("Query completed.");const e={month:"long",day:"numeric"},a=Date.now(),i=new Intl.DateTimeFormat(n.resolvedLocale,e).format(a);t.channel.send({content:"Here is the result of your query.",embed:{color:3447003,description:`${r}Here's Bahaipedia's Today in History entry for ${i}, ${t.author.username}:\n\n ${o}`}})}else t.channel.send({content:"Here is the result of your query.",embed:{color:3447003,description:`${r}Bahaipedia did not return any results for your query, ${t.author.username}. There may have been a network problem. If you think you're getting this message in error, you may want to try again later.`}})}(r,A)}catch(e){return void console.error("Error with today in history",e)}else if(/[\w\s'‘’()-_,.]+/giu.test(d))try{await async function(t,n,r,o,a,i,s){let c;try{c=await e.wikiGetURL(n,r,o,s)}catch(e){console.error("Error getting",e)}console.log("Result:",c);const u=c?.title&&c;if(u){console.log(`Search completed: ${n} => ${u.title}`);const e=/<span class="searchmatch">|<\/span>/giu,r=u.snippet.replace(e,"**");t.channel.send({content:"Here is the result of your search.",embed:{color:3447003,description:`${a}${i} has returned the following page as the top result for your search, ${t.author.username}:\n\n **[${u.title}](${u.url})**\n\n${r}`,image:{url:""!==u.img?u.img:""}}})}else t.channel.send({content:"Here is the result of your search.",embed:{color:3447003,description:`${a}${i} did not return any results for your search, ${t.author.username}. Did you spell your search terms correctly?\n\nThere may also have been a network problem. If you think you're getting this message in error, you may want to try again later.`}})}(r,d,g,v,A,w,k)}catch(e){return void console.error("Error searching wiki",e)}console.log(`BP command issued by ${r.author.username}.`)}const o={re:/!today\b/iu,helpInfo:{name:"!today",value:"Displays a list of events from today's date in history, via Bahaipedia."},action:async e=>await r(e,{forceToday:!0})},a={re:/!(?:b9|bahai9)\b/iu,action:async e=>await r(e)},i={re:/!(?:bm|media|img)\b/iu,action:async e=>await r(e)},s={re:/!(?:bp|pedia)\b/iu,action:r,helpInfo:{name:"!bp | !b9 | !bm [-rand | *‹keyword›*]",value:"Return a link to the top result for *keyword* on Bahaipedia (`!bp`), Bahai9.com (`!b9`), or Bahai.media (`!bm`); `-rand` displays a random article (or file)."}};return{bp:s,today:o,b9:a,bm:i}};const bn="346962599771897859",vn="351854934368583681",wn="346962600212561920",kn="671628531717111808",Sn="346963530836344832",An="644722296929648641",In="325981722082672661",jn="391408369891672064",On="309427494778306560",Tn=[On,"324993843005227008"],Pn=["Admins","Trusted Servant","Mods","Help"],En="ADMINISTRATOR",xn=async function({app:e,router:t,Discord:n,wikiTools:r,client:o,guildCheckin:a,_:i,getLocalizedSetting:s,fs:c,settings:u,discordTTS:l}){const{PUPPET_AUTHOR:f=On,ADMIN_PERMISSION:y=En,ADMIN_IDS:p=Tn,ADMIN_ROLES:h=Pn,enabledCommandGroups:d=["*"],disabledCommandGroups:m=[]}=u,g=d.includes("*"),b=(await Promise.all([["socialInfo",()=>(({ADMIN_ROLES:e,client:t})=>({users:{re:/!users\b/iu,action(t){const{guild:n}=t,r=n.members.cache.filter((e=>"offline"!==e.presence.status)).size,o=n.members.cache.filter((t=>!!t.roles.cache.some((t=>e.includes(t.name)))&&"offline"!==t.presence.status));t.channel.send(`There ${1===r?"is":"are"} currently ${r} user${1===r?"":"s"} online, including ${o.size} admin/mod/helper(s).`),console.log(`Users command issued by ${t.author.username}.`)}},seen:{re:/!seen\b/iu,action(e){const n=e.content.split(" ").filter((e=>!(e.includes("391405681795923968")||e.includes("847456996738334730")||"!seen"===e))).join(" "),r=[],o=t.users.cache.find((e=>e.username===n));if(o){if(o.lastMessage){const e=o.lastMessage.channel,t="dnd"===o.presence.status?"busy":o.presence.status,a=new Date(o.lastMessage.createdAt),i=new Date,s=i>a?i-a:0;r.push(`${n} is now ${t}, and was last seen in ${e} ${de(s/1e3)} ago.`)}else{const e="dnd"===o.presence.status?"busy":o.presence.status;r.push(`${n} is now ${e}; I haven't seen them lately.`)}e.channel.send(r.join("\n")),console.log(`Seen command issued by ${e.author.username}.`)}else r.push(`I haven't seen ${n} lately.`)}}}))({ADMIN_ROLES:h,client:o})],["bahaiWritings",()=>(async({fs:e,settings:t,client:n,Discord:r})=>{const o=await mn({fs:e,settings:t});return{readBook:{re:/\bread (?<refName>\S.+) (?<index>[-.\d]+)\b/iu,action:async e=>await o.readBook(e,n.user.avatarURL(),r)},showList:{re:/\bread list$/iu,action:async e=>await o.showList(e)},readRandom:{re:/\bread random$/iu,action:async e=>await o.readRandom(e,n.user.avatarURL(),r)},read:{re:/!read\b/iu,helpInfo:{name:"!read [list | random | *‹text›* *‹chapter›*]",value:"Reads from the Bahá'í Writings. Displays an excerpt from given *chapter* of *text*. Available texts are displayed using `!read list`; `!read random` displays a random passage from available texts."},action:e=>o.reader(e)}}})({fs:c,settings:u,client:o,Discord:n})],["bahaiWikis",()=>gn({wikiTools:r,client:o,_:i})],["admin",()=>(({ADMIN_IDS:e,ADMIN_PERMISSION:t,PUPPET_AUTHOR:n,discordTTS:r,guildCheckin:o,_:a,client:i})=>({speak:{re:/!speak/iu,async action(t){if(!e.includes(t.author.id))return;const n=t.content.split(" ").slice(2).join(" "),o=i.voice.createBroadcast(),s=t.member.voice.channelID;s||console.log("Message member not in a voice channel with `channelID`");const c=i.channels.cache.get(s),u=await c.join("");o.play(r.getVoiceStream(n));const l=u.play(o);l.on("error",(e=>{console.error(a("speechError"),e)})),l.on("debug",(e=>{console.log(e)})),l.on("start",(()=>{console.log(a("speakingBegun"))}))}},puppet:{re:/!puppet (?:\S.+) \| (?:\S.+)/iu,action(r){e.includes(r.author.id)&&(function({content:e,guild:t,author:n,member:r,channel:o},a){if(n.id===a.authorID){const n=/!puppet (?<userChannel>\S.+) \| (?<msg>\S.+)/iu,r=e.match(n);if(r){const{userChannel:e,msg:n}=r.groups,a=t.channels.cache.find((t=>t.name===e));a?a.send(n):o.send(`Channel ${e} does not exist!`)}}}(r,{authorID:n,permission:t}),console.log(`Puppet command issued by ${r.author.username}.`))}},echo:{re:/!echo\b/iu,action(t){e.includes(t.author.id)&&(t.channel.send(`Here's what you said, ${t.author.username}: \`\`${t.content}\`\``),console.log(`Echo command issued by ${t.author.username}.`))}},checkin:{re:/!checkin\b/iu,async action(t){if(e.includes(t.author.id)){console.log(`Checkin command issued by ${t.author.username}.`);try{return await o()}catch(e){console.error("Error checking in",e)}}}}}))({ADMIN_IDS:p,ADMIN_PERMISSION:y,PUPPET_AUTHOR:f,guildCheckin:a,_:i,client:o,discordTTS:l})],["bahaiInfo",()=>(({client:e,Discord:t})=>({info:{re:/!info/iu,action(n){const r=new t.MessageEmbed;r.setAuthor("BahaiBot",e.user.avatarURL()),r.setDescription("Bahá'í Bot for Discord\n"),r.addField("Support Server","[Invite link](https://discord.gg/NE6dJaw)"),n.channel.send(r)}},badi:{re:/\bbad[íi]\b/iu,action(t){const n=e.emojis.cache.find((e=>"9star"===e.name));t.channel.send(`OK ${t.author.username}, here you go. https://bahaipedia.org/Badí‘${n?` ${n.toString()}`:""}`)}}}))({client:o,Discord:n})],["bahaiSalutations",()=>(({client:e})=>{const t=t=>{const n=e.emojis.cache.find((e=>"9star"===e.name));return n&&t.react(n),n};return{abha:{re:/\b(?:all[aá]h['’´-]?[uo]?['’´-]?abh[aá]|abh[aá])/iu,action(e){const n=t(e);e.channel.send(`Alláh-u-Abhá, ${e.author.username}! ${n?n.toString():""}`)},notMentioned:{check:e=>Boolean(e.mentions.members.first()),action(e){t(e)}}},nawruz:{re:/\b(?:(?:happy|joyous)\s?n[ao]w[- ]?ro?[uú]z|n[ao]w[- ]?ro?[uú]z\s?(?:m[uo]b[aá]r[aá]k))\b/iu,action(n){const r=t(n),o=e.emojis.cache.find((e=>"sabzi"===e.name));n.channel.send(`Happy Naw-Rúz! ${r?r.toString():""}${o?o.toString():""}`)}},ridvan:{re:/\b(?:(?:happy|joyous)\s?r[ie][ḍdz][vw][aá]n|r[ie][ḍdz][vw][aá]n\s?(?:m[uo]b[aá]r[aá]k))\b/iu,action(e){const n=t(e);e.channel.send(`Happy Ridván! ${n?n.toString():""}`)}}}})({client:o})],["salutations",()=>({sup:{re:/\b(?:su+p|wh[au]+[sz]+[au]+p|(?:(?:what|wut)['’´]?s (?:up|new|good|gud|cookin[g'’´])))\b/iu,action(e){const t=["Not much","Not too much","Not a lot","Not very much"],n=t[Math.floor(Math.random()*t.length)],r=["Just glad to be here.","Just happy to be here.","Same as usual.","Same old, same old.","Just like usual.","Just waiting to be of service.","Just waiting to be of service to somebody.","Just waiting to be of service to someone.","Just waiting for questions to answer.","Just waiting for questions I can help answer."],o=r[Math.floor(Math.random()*r.length)];e.channel.send(`${n}, ${e.author.username}. ${o}`)}},morning:{re:/\bgood morning\b/iu,action(e){e.channel.send(`Good morning ${e.author.username}! :coffee:`)}},afternoon:{re:/\bgood afternoon\b/iu,action(e){e.channel.send(`Good afternoon ${e.author.username}!`)}},evening:{re:/\bgood evening\b/iu,action(e){e.channel.send(`Good evening ${e.author.username}!`)}},hello:{re:/\b(?:h[uea]llo|hi|hi there|howdy|yo|heya|sal[aá]{1,2}m)\b/iu,action(e){e.channel.send(`Hello ${e.author.username}!`)}},welcome:{re:/^(?:everyone|everybody)?[!:,\s\W]*(?:please|pleez|pls|plz)?[\s\W]*(?:[\s\W]*welcome|.*>+[\s\W]*welcome\b|.*\bwb\b)/iu,action(e){e.channel.send(`Thanks, ${e.author.username}! :wave:`)},notMentioned:{check:e=>Boolean(e.mentions.members.first()),action(e){e.react("👋")}}}})],["lightHearted",()=>({coffee:{re:/\u{2615}/u,action(e){e.channel.send(":coffee:")},notMentioned:{action(e){e.react("☕")}}},tea:{re:/\u{1F375}/u,action(e){e.channel.send(":tea:")},notMentioned:{action(e){e.react("🍵")}}},popcorn:{re:/\u{1F37F}/u,action(e){e.channel.send(":popcorn:")},notMentioned:{action(e){e.react("🍿")}}},unladen:{re:/\bunladen\sswallow\b/iu,action(e){e.channel.send("What do you mean, an African, or European swallow?")}},bruh:{re:/\bbruh\b/iu,action(e){e.channel.send("Bruh.")}},goodbot:{re:/\bgood\s?bot\b/iu,action(e){e.react("😊"),e.channel.send("Thanks!")}},badbot:{re:/\bbad\s?bot\b/iu,action(e){e.react("☹️"),e.channel.send("Sorry.")}},repeating:{re:/\brepeating yourself\b/iu,action(e){const t=["Oops, sorry...","Oops, sorry!","Sorry!","Oops!","Sorry...","Sorry... :sweat_smile:","Oops, sorry... :sweat_smile:"],n=t[Math.floor(Math.random()*t.length)],r=["I tend to do that, don't I?","I guess I tend to do that, don't I?","I suppose I tend to do that, don't I?","I'm just a chatbot, after all.","I am a chatbot, after all.","I *am* a chatbot, after all.","That does happen a lot, doesn't it."],o=r[Math.floor(Math.random()*r.length)];e.channel.send(`${n} ${o}`)}},santacat:{re:/\b(?:my|santa['’´]?s)\scat\b/iu,action(e){const t=["Not telling.","That's a secret to everybody.","Didn't somebody make a meme out of it?","Which one? This one? :cat2:","Wouldn't you like to know.","Who do you think I am? Schrödinger?"],n=t[Math.floor(Math.random()*t.length)];e.channel.send(n)}},ping:{re:/\bping\b/iu,action(e){e.channel.send("Pong :ping_pong:")}}})]].map((async([e,t])=>!g&&!d.includes(e)||m.includes(e)?null:await t())))).reduce(((e,t)=>e={...e,...t}),{});return(({commands:e})=>{const t={re:/!help\b/iu,helpInfo:{name:"!help",value:"Displays help text."},action(e){e.channel.send({content:`Here are the instructions you need, ${e.author.username}.`,embed:{color:8359053,description:"I can respond to well-formed questions about basic Baha'i topics. As well, the following commands can help me process your requests. Make sure to mention me when trying to use them, like this: `@BahaiBot !help`",fields:n}})}};e.help=t;const n=[...Object.values(e).map((({helpInfo:e})=>e)).filter((e=>e))]})({commands:b}),b.default=(({app:e,router:t,client:n,Discord:r,_:o,settings:a})=>({re:/[\s\S]*/u,async action(i){const s=i.content.trimStart().replace(/<@!?(?<snowflake>\d+)>/gu,((e,t,r,o,{snowflake:a})=>{if(a===n.user.id)return"";const{username:i}=n.users.resolve(a);return i})),c=i.author.id,u={session:e.projectAgentSessionPath(a.PROJECT_ID,c),queryInput:{text:{text:s,languageCode:o.resolvedLocale}}};return await async function(){try{const[a]=await e.detectIntent(u);return await t(a,i,n,r,o),a}catch(e){throw i.channel.send(`<@${i.author.id}>, I couldn't process your question at the moment.`),e}}()}}))({app:e,router:t,client:o,Discord:n,_:i,settings:u}),b},Rn=(e,t,n,r,o)=>{console.log(o("routerResponse"),e);const a=e.queryResult.fulfillmentText;t.channel.send(a)},Mn={debugCheckin:["Hi","Hi","Hi there","Hello","Hello","Hello there","Hey","What's up","What's new"],fyiCheckin:{general:["Hi, everyone.","Hi, everybody.","Hi, everyone.","Hi there, everyone!","Hello, everyone.","Hello there, everyone.","Alláh-u-Abhá!","Alláh’u’abhá, everyone.","Alláh-u-Abhá, everyone.","What's cooking, everybody?","Hey all, what's cooking?","What's up, everyone?","What's good, everyone?","Hey everyone, what's new?","Hey everybody, what's up?","Hey, what's up everyone?","Hi everybody, what's up?"],ircBridge:["Hello IRC.","Hi, everybody.","Hi, everyone.","Hi there, everyone!","Hello, everyone.","Hello there, everyone.","Alláh-u-Abhá!","Alláh-u-Abhá, IRC.","Alláh-u-Abhá, everyone.","What's cooking, everybody?","Hey all, what's cooking?","What's up, everyone?","What's good, everyone?","Hey everyone, what's new?","Hey everybody, what's up?","Hey, what's up everyone?","Hi everybody, what's up?"]},guildMemberAdd:["Hi","Hi","Hi there","Hello","Hello","Hello there","Hey","What's up","What's new"]},$n={guildMemberAdd:e=>["Happy to have you with us!","Pleased to have you with us!","Great to have you with us!","It's great to have you with us!","It's a pleasure to have you with us!","Pleased to have you with us! :smile:","It's a pleasure to have you with us! :smile:","Happy to have you with us! :smile:","Great to have you with us! :smile:",`Happy to have you with us! ${e}`,"Glad you could join us! :smile:",`Glad you could join us! ${e}`,"Happy to have you with us today!","Pleased to have you with us today!","Great to have you with us today!","It's great to have you with us today!","It's a pleasure to have you with us today!","Pleased to have you with us today! :smile:","It's a pleasure to have you with us today! :smile:","Happy to have you with us today! :smile:","Great to have you with us today! :smile:",`Happy to have you with us today! ${e}`,"Glad you could join us today! :smile:",`Glad you could join us today! ${e}`]},Nn=Date.now();const Dn=["en-US"],Fn=async({checkins:e=!1,locales:t=("undefined"==typeof navigator?["en-US"]:[...navigator.languages.filter((e=>Dn.includes(e))),"en-US"]),fetch:n=window.fetch,i18n:r=window?.intlDom?.i18n,striptags:o=window.striptags,client:a,Discord:i,discordTTS:s,dialogflow:c,fs:u,getSettings:l,getPath:f,numberOfCommands:y=1,commandInterval:p=2e3,rateLimiter:h=new ae.RateLimiter(1,p),exitNoThrow:d=!1}={})=>{const m=a||new i.Client,g=JSON.parse(await u.readFile(f("settings.json"),"utf8")),b="function"==typeof l?l:e=>e.development,v=b(g),w=new c.SessionsClient({keyFilename:f(v.PROJECT_JSON)}),{token:k,disableNotMentioned:S=!1,welcomeChannel:A="welcome",awesomeEmoji:I="awesome",helpTeam:j=An,rulesChannel:O=vn}=v,T=await r({localesBasePath:"src",locales:t}),P=(e,{defaultValue:t}={})=>v?.locales?.[T.resolvedLocale][e]||t||T(e),E=function({fetch:e,striptags:t,_:n}){return{async bpGetToday(){const r=Date.now(),o={action:"parse",page:`Bahaipedia:Today_in_History/${new Intl.DateTimeFormat(n.resolvedLocale,{month:"long",day:"numeric"}).format(r).toString()}`,prop:"text",format:"json"},a=`https://bahaipedia.org/api.php?${new URLSearchParams({...o,origin:"*"})}`;try{const n=(await(await e(a)).json()).parse.text["*"].split("</center>\n");return t(n.length>1?n[1]:n[0])}catch(e){return console.error("Error retrieving JSON for today URL",a,e),""}},async wikiGetRandom(t,n,r){const o=`https://${n}/api.php?${new URLSearchParams({action:"query",indexpageids:"1",prop:"bahai.media"===n?"imageinfo":"",iiprop:"bahai.media"===n?"url":"",generator:"random",grnnamespace:"bahai.media"===n?"6":"0",grnlimit:t,format:"json",origin:"*"})}`;try{const t=await(await e(o)).json(),a=t.query.pages[t.query.pageids[0]].title;return{title:a,url:`https://${n}/${r?"wiki/":""}${encodeURIComponent(a)}`,img:"bahai.media"===n?t.query.pages[t.query.pageids[0]].imageinfo[0].url:""}}catch(e){return console.error("Error retrieving random wiki URL",o,e),""}},async wikiGetURL(t,n,r,o=!1){const a=`https://${r}/api.php?${new URLSearchParams({action:"query",list:"search",generator:"search",prop:"bahai.media"===r?"imageinfo":"",iiprop:"bahai.media"===r?"url":"",srsearch:t,srnamespace:"bahai.media"===r?"6":"0",srlimit:n,srprop:"snippet",gsrsearch:t,gsrnamespace:"bahai.media"===r?"6":"0",gsrlimit:n,format:"json",origin:"*"})}`;try{const t=await(await e(a)).json();if(0!==t.query.searchinfo.totalhits){const e=t.query.search[0].title;return{title:e,url:`https://${r}/${o?"wiki/":""}${encodeURIComponent(e)}`,snippet:t.query.search[0].snippet,img:"bahai.media"===r?t.query.pages[t.query.search[0].pageid].imageinfo[0].url:""}}return!1}catch(e){return void console.error("Error retrieving wiki search URL",a,e)}}}}({fetch:n,striptags:o,_:T}),x=function({client:e,fs:t,wikiTools:n,settings:r,getLocalizedSetting:o,_:a}){const{bstarEmoji:i="bstar",checkinGuilds:s=[{guildID:In,guildName:o("labServerName"),guildChannels:[{id:jn,greetings:o("debugCheckin",{defaultValue:Mn.debugCheckin}),reportUptime:!0}]},{guildID:bn,guildName:o("serverName"),guildChannels:[{id:wn,greetings:o("fyiCheckin-general",{defaultValue:Mn.fyiCheckin.general})},{id:kn,greetings:o("fyiCheckin-ircBridge",{defaultValue:Mn.fyiCheckin.ircBridge})},{id:Sn,bpToday:!0}]}]}=r;return async function(r=Date.now()){let o;for(const{guildID:t,guildName:n,guildChannels:r}of s){const i=e.guilds.cache.get(t);if(i&&(console.log(a("checkingIn",{guildName:n})),o=r.map((({id:e,greetings:t,bpToday:r,reportUptime:o})=>({guildName:n,bpToday:r,greetings:t,reportUptime:o,channel:i.channels.cache.get(e)}))).filter((({channel:e})=>e)),!o.length))return}if(!o)return;const c={list:[o.map((({channel:{name:e}})=>`#${e}`))]},u="greet.guild.txt";try{const e=await t.stat(u),n=(r-new Date(e.mtime).getTime())/1e3;console.log(a("lastGreeting",{relativeTime:de(Math.floor(n)),channels:c}))}catch(e){console.log(a("firstGreet",{channels:c}))}let l;o.some((({bpToday:e})=>e))&&(l=await n.bpGetToday());for(const{channel:t,bpToday:n,greetings:s,guildName:c,reportUptime:u}of o){if(console.log(a("channelFound",{guildName:c,channelName:t.name})),s){const e=s[Math.floor(Math.random()*s.length)];if(u){const n=new Date,o=r-Nn;t.send(a("uptimeGreet",{greet:e,now:n.toString(),uptime:de(Math.floor(o/1e3))}))}else t.send(e)}if(!n||!l)continue;const o=e.emojis.cache.find((e=>e.name===i));console.log(a("postingTodayInHistory")),t.send({content:a("hereIsQueryResult"),embed:{color:3447003,description:a("todayInHistoryResult",{today:{date:[Date.now(),{month:"long",day:"numeric"}]},bstar:o?.toString()??"",todayInHistoryResult:l})}})}try{await t.writeFile(u,r.toString()),console.log(a("greetingSent",{channels:c}))}catch(e){console.error(a("errorWritingGuild",{guildFileName:u}),e)}}}({client:m,fs:u,wikiTools:E,settings:v,getLocalizedSetting:P,_:T}),R=await xn({app:w,router:Rn,Discord:i,wikiTools:E,client:m,guildCheckin:x,_:T,getLocalizedSetting:P,fs:u,settings:v,discordTTS:s});return m.on("ready",(()=>{console.log(T("BahaiBotOnline")),e&&(m.user.setPresence({activity:{name:"@BahaiBot !help",type:"PLAYING"}}),function(e,t=1e3,{exitNoThrow:n=!1}={}){let r,o=Date.now()+t;r=setTimeout((function a(){const i=Date.now()-o;if(i>t){if(n)return;throw new Error(`Unexpected condition: ${i} time drift exceeding interval ${t}`)}const s=e(t)||0;o+=t+s,r=setTimeout(a,Math.max(0,t-i)+s)}),t)}((e=>{const t=new Date;if(12===t.getUTCHours()){if(t.getUTCMinutes()<15)return 24e5-e;x()}return 0}),3e6,{exitNoThrow:d}))})),m.on("message",(async e=>{if(e.mentions.has(m.user)){if((e=>h.take(e.author.id))(e))return;for(const t of Object.values(R))if(t.re.test(e.content)){try{await t.action(e)}catch(t){console.error(T("errorExecuting")),console.error(e.content,t)}m.emit("bahaibot:command-finished");break}m.emit("bahaibot:command-finished")}else if(!S){const t=Object.values(R).filter((e=>e.notMentioned));for(const{re:n,notMentioned:r}of t)if(n.test(e.content)&&(!r.check||r.check(e))){await r.action(e),m.emit("bahaibot:command-finished");break}m.emit("bahaibot:command-finished")}})),m.on("guildMemberAdd",(e=>{const t=e.guild.channels.cache.find((e=>e.name===A));if(!t)return;const n=m.emojis.cache.find((e=>e.name===I)),r=P("greet-guildMemberAdd",{defaultValue:Mn.guildMemberAdd}),o=r[Math.floor(Math.random()*r.length)],a=P("happies",{defaultValue:$n}),i=n?a.guildMemberAdd(n.toString()):a.guildMemberAdd(":smile:"),s=i[Math.floor(Math.random()*i.length)];t.send(T("guildMemberAddWelcome",{userID:`<@!${e.user.id}>`,greet:o,happy:s,serverName:P("serverName"),helpTeam:`<@&${j}>`,rulesChannel:e.guild.channels.cache.get(O).toString()}))})),m.login(k),{client:m,botCommands:R,guildCheckin:x,system:g,getSettings:b}},{hash:Bn,search:Ln}=location,Un=Bn.slice(1),_n=[new URLSearchParams(Un).get("locales")||new URLSearchParams(Ln).get("locales")],Cn=new URLSearchParams(Un).get("checkins")||new URLSearchParams(Ln).get("checkins"),Hn=e=>`${location.href.replace(/\/$/u,"")}/${e}`,Gn={readFile:async e=>await(await fetch(e?.href??e)).text(),writeFile(e,t){localStorage.setItem(`bahaibot-${e}`,t||Date.now())},stat:e=>localStorage.getItem(`bahaibot-${e}`),unlink(e){localStorage.removeItem(e)}};function Wn(e){return Fn({checkins:Cn,locales:_n,getPath:Hn,fs:Gn,fetch:fetch,i18n:te,striptags:oe,...e})}export{Wn as default};
//# sourceMappingURL=integratedClientServerBot.esm.min.js.map
